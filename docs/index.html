// Replace with your Render API URL after deployment
const API_BASE_URL = 'https://pawcraft-api.onrender.com';

async function trackDownload() {
    const downloadUrl = 'https://github.com/justdev-chris/PawCraft/releases/download/released/PawCraft.zip';
    
    try {
        // Track download on your Render API
        await fetch(`${API_BASE_URL}/api/track-download`, {
            method: 'POST'
        });
        
        // Start download
        const link = document.createElement('a');
        link.href = downloadUrl;
        link.download = 'PawCraft.zip';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        // Update stats display
        updateStats();
    } catch (error) {
        // Fallback if API is down
        console.log('API offline, downloading without tracking');
        const link = document.createElement('a');
        link.href = downloadUrl;
        link.download = 'PawCraft.zip';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
}

async function updateStats() {
    try {
        const response = await fetch(`${API_BASE_URL}/api/stats`);
        const stats = await response.json();
        
        document.getElementById('downloadCount').textContent = stats.downloads;
        document.getElementById('onlineCount').textContent = stats.online;
    } catch (error) {
        console.log('Could not fetch stats');
    }
}

// Update stats every 30 seconds
setInterval(updateStats, 30000);
updateStats();